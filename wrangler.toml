name = "nico-ranking-api-gateway"
main = "workers/api-gateway-simple.ts"
compatibility_date = "2024-01-01"
workers_dev = true

# Environment variables
[vars]
NEXT_APP_URL = "https://nico-ranking-custom-yjsns-projects.vercel.app"
USE_PREVIEW = "false"  # "true" でプレビュー環境を使用

# Account settings
account_id = "<your-cloudflare-account-id>"

# KV Namespaces
[[kv_namespaces]]
binding = "RATE_LIMIT"
id = "<your-rate-limit-namespace-id>"
preview_id = "<your-rate-limit-namespace-id>"

[[kv_namespaces]]
binding = "RANKING_DATA"
id = "<your-kv-namespace-id>"
preview_id = "<your-kv-namespace-id>"

# Routes
[[routes]]
pattern = "nico-rank.com/*"
zone_name = "nico-rank.com"

[[routes]]
pattern = "www.nico-rank.com/*"
zone_name = "nico-rank.com"

# Development settings
[dev]
port = 8787
local_protocol = "http"
ip = "0.0.0.0"

# Build settings
[build]
command = ""

# Performance settings
# [limits]
# cpu_ms = 50  # CPU limits require paid plan
# memory_mb = 128

# Compatibility settings
# compatibility_flags = ["nodejs_compat"]

# Preview environment for current branch
[env.preview]
name = "nico-ranking-api-gateway-preview"
vars = { NEXT_APP_URL = "https://nico-ranking-custom-git-feat-vercel-conve-921a4d-yjsns-projects.vercel.app" }

[[env.preview.routes]]
pattern = "preview.nico-rank.com/*"
zone_name = "nico-rank.com"

[[env.preview.kv_namespaces]]
binding = "RATE_LIMIT"
id = "<your-rate-limit-namespace-id>"

[[env.preview.kv_namespaces]]
binding = "RANKING_DATA"
id = "<your-kv-namespace-id>"