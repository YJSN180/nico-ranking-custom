# ãƒ‹ã‚³ãƒ‹ã‚³ãƒ©ãƒ³ã‚­ãƒ³ã‚° (Re:turn)

[![CI](https://github.com/YJSN180/nico-ranking-custom/actions/workflows/ci.yml/badge.svg)](https://github.com/YJSN180/nico-ranking-custom/actions/workflows/ci.yml)
[![Update Nico Ranking Data](https://github.com/YJSN180/nico-ranking-custom/actions/workflows/update-ranking-parallel.yml/badge.svg)](https://github.com/YJSN180/nico-ranking-custom/actions/workflows/update-ranking-parallel.yml)

ãƒ‹ã‚³ãƒ‹ã‚³å‹•ç”»ã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’è¡¨ç¤ºã™ã‚‹Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€‚24æ™‚é–“ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã¨æ¯æ™‚ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’é«˜é€Ÿã«é…ä¿¡ã—ã¾ã™ã€‚

## ğŸŒ ã‚µã‚¤ãƒˆ

[https://nico-rank.com](https://nico-rank.com)

## âœ¨ ç‰¹å¾´

- **é«˜é€Ÿè¡¨ç¤º**: Cloudflare KVã«ã‚ˆã‚‹ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã§ç¬æ™‚ã«è¡¨ç¤º
- **è‡ªå‹•æ›´æ–°**: 10åˆ†ã”ã¨ã«æœ€æ–°ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’å–å¾—
- **å¤šã‚¸ãƒ£ãƒ³ãƒ«å¯¾å¿œ**: å…¨23ã‚¸ãƒ£ãƒ³ãƒ«ã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã«å¯¾å¿œ
- **ã‚¿ã‚°åˆ¥ãƒ©ãƒ³ã‚­ãƒ³ã‚°**: äººæ°—ã‚¿ã‚°ã§ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ©Ÿèƒ½
- **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–**: PCãƒ»ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ä¸¡å¯¾å¿œ
- **ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰**: 3ç¨®é¡ã®ãƒ†ãƒ¼ãƒã‹ã‚‰é¸æŠå¯èƒ½
- **NGãƒ•ã‚£ãƒ«ã‚¿**: ä¸è¦ãªå‹•ç”»ã‚’éè¡¨ç¤ºã«ã™ã‚‹æ©Ÿèƒ½

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Cloudflare    â”‚â”€â”€â”€â”€â–¶â”‚     Vercel      â”‚â”€â”€â”€â”€â–¶â”‚   Nico Nico    â”‚
â”‚    Workers      â”‚     â”‚   (Next.js)     â”‚     â”‚     API        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                                â”‚
         â”‚                                                â”‚
         â–¼                                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Cloudflare KV  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  GitHub Actions â”‚
â”‚  (Cache Store)  â”‚      (Fallback Update)     â”‚   (Cron Job)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

- **Vercel**: Next.js ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°
- **Cloudflare Workers**: API Gateway & ãƒ¬ãƒ¼ãƒˆåˆ¶é™
- **Cloudflare KV**: ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
- **GitHub Actions**: ãƒ‡ãƒ¼ã‚¿æ›´æ–°ã®cronã‚¸ãƒ§ãƒ–ï¼ˆ10åˆ†é–“éš”ï¼‰

## ğŸ¨ ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ³ãƒˆè¨­å®š

ã‚¿ã‚¤ãƒˆãƒ«ã«ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚ä»¥ä¸‹ã®ãƒ•ã‚©ãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®ã—ã¦ãã ã•ã„ï¼š

1. **ãƒ‹ã‚³ãƒ¢ã‚¸+v2** (ãƒ‹ã‚³ãƒ‹ã‚³ãƒ©ãƒ³ã‚­ãƒ³ã‚°éƒ¨åˆ†)
   - ãƒ•ã‚¡ã‚¤ãƒ«å: `nicomoji-plus_v2-5.ttf`
   - é…ç½®å…ˆ: `public/fonts/nicomoji-plus-v2.ttf`

2. **Comic Sans MS Bold** ((Re:turn)éƒ¨åˆ†)
   - ãƒ•ã‚¡ã‚¤ãƒ«å: `comic-sans-ms.ttf`
   - é…ç½®å…ˆ: `public/fonts/comic-sans-ms-bold.ttf`

ãƒ•ã‚©ãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãŒãªã„å ´åˆã¯ã€ä»£æ›¿ãƒ•ã‚©ãƒ³ãƒˆãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

## ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å‰ææ¡ä»¶

- Node.js 20.x
- npm 10.x
- Cloudflare ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ
- Vercel ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/YJSN180/nico-ranking-custom.git
cd nico-ranking-custom

# ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install

# ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
cp .env.example .env.local
# .env.localã‚’ç·¨é›†ã—ã¦å¿…è¦ãªå€¤ã‚’è¨­å®š

# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•
npm run dev
```

### ç’°å¢ƒå¤‰æ•°

`.env.local`ã«ä»¥ä¸‹ã®ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šï¼š

```env
# Cloudflare KV
CLOUDFLARE_ACCOUNT_ID=your_account_id
CLOUDFLARE_KV_NAMESPACE_ID=your_namespace_id
CLOUDFLARE_KV_API_TOKEN=your_api_token

# èªè¨¼
CRON_SECRET=your_cron_secret
ADMIN_USERNAME=your_admin_username
ADMIN_PASSWORD=your_admin_password
WORKER_AUTH_KEY=your_worker_key
```

## ğŸ“ é–‹ç™º

### åˆ©ç”¨å¯èƒ½ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```bash
npm run dev          # é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run build        # ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰
npm run start        # ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run lint         # ESLintå®Ÿè¡Œ
npm run typecheck    # TypeScriptå‹ãƒã‚§ãƒƒã‚¯
npm test             # ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm run test:e2e     # E2Eãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
```

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
.
â”œâ”€â”€ app/              # Next.js App Router
â”œâ”€â”€ components/       # Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”œâ”€â”€ lib/              # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
â”œâ”€â”€ types/            # TypeScriptå‹å®šç¾©
â”œâ”€â”€ workers/          # Cloudflare Workers
â”œâ”€â”€ __tests__/        # ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
â””â”€â”€ public/           # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
```

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

- ç®¡ç†ç”»é¢ã¯Basicèªè¨¼ã§ä¿è­·
- ãƒ¬ãƒ¼ãƒˆåˆ¶é™å®Ÿè£…ï¼ˆ3å±¤æ§‹é€ ï¼‰
- CSPãƒ˜ãƒƒãƒ€ãƒ¼è¨­å®š
- ç’°å¢ƒå¤‰æ•°ã«ã‚ˆã‚‹æ©Ÿå¯†æƒ…å ±ç®¡ç†

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯MITãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ä¸‹ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚

## ğŸ¤ è²¢çŒ®

Issue ã‚„ Pull Request ã¯æ­“è¿ã—ã¾ã™ã€‚å¤§ããªå¤‰æ›´ã‚’è¡Œã†å ´åˆã¯ã€ã¾ãš Issue ã‚’ä½œæˆã—ã¦è­°è«–ã—ã¦ãã ã•ã„ã€‚

## ğŸ“ ãŠå•ã„åˆã‚ã›

å•é¡Œã‚„è³ªå•ãŒã‚ã‚‹å ´åˆã¯ã€[Issues](https://github.com/YJSN180/nico-ranking-custom/issues) ã§ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚